import{m as K,n as x,q as E,r as I,s as T,v as _,x as q,o as c,c as d,a as y,y as A,z as r,A as s,F as P,B as $,C as z,t as b,D as k,E as N}from"./entry.51a61baf.js";const L={key:0},O=["value","onFocus","onKeydown","onPaste"],U={__name:"index",props:{id:{type:String,required:!0},title:{type:String,default:"2FA"},modelValue:{type:String,default:""},invalid:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},hideTitle:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(f){const o=f,{t:B}=K({useScope:"global"}),n=x("ui-code-input"),{value:u,errorMessage:m,meta:V,handleChange:p,handleBlur:C}=E(I(o,"id"),"required|length:6",{validateOnValueUpdate:!1,initialValue:o.modelValue,syncVModel:!0}),i=T(null);let v=!1;const h=_(()=>o.invalid||!!m.value&&V.touched),F=_(()=>o.invalid?B("validation.invalid_code"):m.value);function w(e){u.value.length<6&&e>u.value.length&&i.value[u.value.length].focus()}async function M(e,a){const t=u.value;let l;if(/^\d+$/.test(a.key)){const g=t.substring(0,e-1)+a.key+t.substring(e);p(g,!1),l=i.value[e]}else if(a.key==="Backspace"&&t){const g=t.substring(e-1,e);p(u.value.substring(0,e-1),!1),g||(l=i.value[Math.max(e-2,0)])}!a.ctrlKey&&!a.metaKey&&!["Tab","Enter"].includes(a.key)&&a.preventDefault(),await N(),l&&(v=!0,a.target.blur(),l.focus(),v=!1)}function S(e){var t;const a=(t=e.clipboardData)==null?void 0:t.getData("text");/^\d{6}/.test(a)&&(p(a.substring(0,6)),e.target.blur())}function D(e){v||C(e)}return q(()=>{o.autofocus&&i.value[0].focus()}),(e,a)=>(c(),d("div",{class:r([s(n).b(),s(n).is("invalid",h.value)])},[y("div",{class:r([s(n).e("label")])},[A(e.$slots,"title",{},()=>[f.hideTitle?k("",!0):(c(),d("p",L,b(f.title),1))])],2),y("div",{class:r([s(n).e("wrapper")])},[(c(),d(P,null,$(6,t=>y("input",{key:t,ref_for:!0,ref_key:"digitInputs",ref:i,type:"text",class:r([s(n).e("digit")]),value:s(u).charAt(t-1),inputmode:"numeric",onFocus:l=>w(t),onBlur:D,onKeydown:l=>M(t,l),onPaste:z(S,["prevent"])},null,42,O)),64))],2),h.value?(c(),d("p",{key:0,class:r([s(n).e("validation-message")])},b(F.value),3)):k("",!0)],2))}};export{U as default};
